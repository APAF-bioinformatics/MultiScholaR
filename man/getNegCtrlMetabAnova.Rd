% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metaboliteVsSamplesS4Objects.R
\name{getNegCtrlMetabAnova,MetaboliteAssayData-method}
\alias{getNegCtrlMetabAnova,MetaboliteAssayData-method}
\title{Get Negative Control Features using ANOVA (Metabolites)}
\usage{
\S4method{getNegCtrlMetabAnova}{MetaboliteAssayData}(
  theObject,
  ruv_grouping_variable = NULL,
  percentage_as_neg_ctrl = NULL,
  num_neg_ctrl = NULL,
  ruv_qval_cutoff = NULL,
  ruv_fdr_method = NULL
)
}
\arguments{
\item{theObject}{A \code{MetaboliteAssayData} object.}

\item{ruv_grouping_variable}{Character string. The column name in the
\code{design_matrix} to use for grouping in the ANOVA (e.g., biological replicate
group, batch). Defaults are looked up via \code{checkParamsObjectFunctionSimplify}
using the key \code{"ruv_grouping_variable"}.}

\item{percentage_as_neg_ctrl}{Numeric (0-100). The percentage of total features
to select as negative controls based on ANOVA p-value ranking. Overridden by
\code{num_neg_ctrl} if provided. Defaults are looked up via
\code{checkParamsObjectFunctionSimplify} using the key \code{"metabolites_percentage_as_neg_ctrl"}.}

\item{num_neg_ctrl}{Integer. The absolute number of features to select as
negative controls. Overrides \code{percentage_as_neg_ctrl}. Defaults are looked up via
\code{checkParamsObjectFunctionSimplify} using the key \code{"metabolites_num_neg_ctrl"}.}

\item{ruv_qval_cutoff}{Numeric. The q-value (adjusted p-value) threshold used
internally by the ANOVA helper function (typically for filtering before ranking,
though ranking is the primary selection method here). Defaults are looked up via
\code{checkParamsObjectFunctionSimplify} using the key \code{"ruv_qval_cutoff"}.}

\item{ruv_fdr_method}{Character string. The method used for p-value adjustment
(e.g., "BH", "fdr"). Defaults are looked up via
\code{checkParamsObjectFunctionSimplify} using the key \code{"ruv_fdr_method"}.}
}
\value{
A named list, where each element corresponds to an assay in the input
object. Each element contains a logical vector indicating which features
(metabolites) in that assay were selected as negative controls. The vector
is named with the feature IDs.
}
\description{
Identifies potential negative control features (metabolites) for RUV correction
based on ANOVA across a specified grouping variable. Features with the least
significant variation across the groups are selected.
}
\details{
This method iterates through each assay in the \code{MetaboliteAssayData} object.
}
\section{Functions}{
\itemize{
\item \code{getNegCtrlMetabAnova(MetaboliteAssayData)}: Method for MetaboliteAssayData

}}
