% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/func_pept_s4_objects.R
\name{findBestNegCtrlPercentagePeptides,PeptideQuantitativeData-method}
\alias{findBestNegCtrlPercentagePeptides,PeptideQuantitativeData-method}
\title{Find the Best Negative Control Percentage for RUV-III Analysis on Peptide Data}
\usage{
\S4method{findBestNegCtrlPercentagePeptides}{PeptideQuantitativeData}(
  theObject,
  percentage_range = seq(1, 20, by = 1),
  num_components_to_impute = 5,
  ruv_grouping_variable = "group",
  ruv_qval_cutoff = 0.05,
  ruv_fdr_method = "qvalue",
  separation_metric = "max_difference",
  k_penalty_weight = 0.5,
  max_acceptable_k = 3,
  adaptive_k_penalty = TRUE,
  verbose = TRUE,
  ensure_matrix = TRUE
)
}
\arguments{
\item{percentage_range}{A numeric vector specifying the range of percentages to test.
Default is seq(1, 20, by = 1) for testing 1\% to 20\% in 1\% increments}

\item{num_components_to_impute}{Number of components to use for imputation in ruvCancor.
Default is 5}

\item{ruv_grouping_variable}{The grouping variable to use for RUV analysis.
Default is "group"}

\item{ruv_qval_cutoff}{The FDR threshold for negative control selection.
Default is 0.05}

\item{ruv_fdr_method}{The FDR calculation method. Default is "qvalue"}

\item{separation_metric}{The metric to use for evaluating separation quality.
Options: "max_difference" (default), "mean_difference", "auc", "weighted_difference"}

\item{k_penalty_weight}{Weight for penalizing high k values in composite score.
Default is 0.5. Higher values penalize high k more strongly}

\item{max_acceptable_k}{Maximum acceptable k value. k values above this get heavy penalty.
Default is 3}

\item{adaptive_k_penalty}{Whether to automatically adjust max_acceptable_k based on sample size.
Default is TRUE (recommended). Set to FALSE only if you need exact reproducibility with previous results}

\item{verbose}{Whether to print progress messages. Default is TRUE}

\item{ensure_matrix}{Whether to ensure peptide matrix is calculated. Default is TRUE}

\item{peptide_matrix_obj}{A PeptideQuantitativeData object containing
the peptide quantification data}
}
\value{
A list containing:
\itemize{
\item best_percentage: The optimal percentage as a numeric value
\item best_k: The optimal k value from findBestK() for the best percentage
\item best_control_genes_index: The control genes index for the best percentage
\item best_separation_score: The separation score for the best percentage
\item best_composite_score: The composite score (separation penalized by k value)
\item optimization_results: A data frame with all tested percentages and their scores
\item best_cancor_plot: The canonical correlation plot for the best percentage
\item separation_metric_used: The separation metric that was used
\item k_penalty_weight: The k penalty weight that was used
\item max_acceptable_k: The maximum acceptable k value that was used
}
}
\description{
This function automatically determines the optimal percentage of peptides to use
as negative controls for RUV-III analysis by testing different percentages and
evaluating the separation quality between "All" and "Control" groups in canonical
correlation plots.
}
